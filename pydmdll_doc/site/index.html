<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="None">
  
  
  <link rel="shortcut icon" href="img/favicon.ico">
  <title>pydmdll</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="css/theme.css" />
  <link rel="stylesheet" href="css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
  <link href="assets/_mkdocstrings.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "\u9996\u9875";
    var mkdocs_page_input_path = "index.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="js/jquery-2.1.1.min.js" defer></script>
  <script src="js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="." class="icon icon-home"> pydmdll</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href=".">首页</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#_1">前言</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_2">简介</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_3">项目</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_4">功能</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_5">安装</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_6">开始</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_7">其他</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_8">系统权限</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_9">键盘代码</a>
    </li>
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="doc/">文档</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href=".">pydmdll</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".">Docs</a> &raquo;</li>
    
      
    
    <li>首页</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h1 id="welcome-to-pydmdll">Welcome to pydmdll</h1>
<h3 id="_1">前言</h3>
<p>Python模拟鼠标键盘的包有很多，它们的文档也很全，功能也很人性化，最后实在没有办法了再使用本包，推荐结合使用。比如：本包没有监听键盘的功能，你完全可以再开一个线程，使用Keyboard进行监听。</p>
<ul>
<li>PyAutoGUI侧重于鼠标，键盘，截图，消息框的功能  </li>
<li>Pywinauto侧重对CS的操作，对进程，窗体进行操作  </li>
<li>Keyboard侧重于键盘，监听键盘，设置热键，键盘记录等功能</li>
</ul>
<h3 id="_2">简介</h3>
<p><strong>仅支持32位Python3</strong>，封装了大漠插件免费功能部分，实现了用python来调用模拟键盘驱动库dm.dll,主要是解决鼠标在游戏内部无法拖拽的问题。</p>
<h3 id="_3">项目</h3>
<ul>
<li><a href="https://github.com/Gaoyongxian666/pydmdll">Github</a></li>
<li><a href="https://pydmdll.readthedocs.io/en/latest/">在线文档</a></li>
</ul>
<h3 id="_4">功能</h3>
<ul>
<li>模拟键盘：输入，输出，按键，点击等</li>
<li>窗口功能：最小化，激活，移动，获取窗口句柄等</li>
<li>基本功能：剪贴板，蜂鸣器等</li>
</ul>
<h3 id="_5">安装</h3>
<pre><code>pip install pydmdll
</code></pre>
<h3 id="_6">开始</h3>
<pre><code>from pydmdll import DM

if __name__ == '__main__':
    dm=DM()

    os.system("start notepad.exe")
    time.sleep(1)

    # 窗口句柄就是一个int类型的数字
    txt_hwnd=dm.FindWindow("","记事本")
    print(txt_hwnd)

    # 最大化指定窗口,同时激活窗口.
    f=dm.SetWindowState(txt_hwnd,4)
    print(f)

    # 使记事本窗口移动
    dm.MoveWindow(txt_hwnd,10,10)

    # 向指定窗口输入字符串
    dm.SendString(txt_hwnd,"你好帅了")

    # 打印注册路径
    path=dm.GetBasePath()
    print(path)

    # 获取标题还有.py的所有句柄
    # 注意：返回的是str，但句柄必须是int类型，要强行转化
    # hwnd_str_list=dm.EnumWindow(0,".py","",1+2+4+8).split(",")
    # print(hwnd_str_list)
    # for hwnd in hwnd_str_list:
    #     print(dm.GetWindowClass(int(hwnd)))
    #     print(dm.GetWindowProcessPath(int(hwnd)))
    #     print(dm.GetWindowTitle(int(hwnd)))
    #     dm.MoveWindow(int(hwnd),100,100)

    # 推荐相对移动
    dm.MoveR(100,100)
</code></pre>
<h3 id="_7">其他</h3>
<p>本包可以直接使用，不用手动注册dll，首次运行会自动调用UCA管理员注册。 如果你是想使用你自己本地的dm.dll或者打包应用，那你就需要传递本地路径参数了。  </p>
<p>大型游戏一般为了效率通常直接读写硬件接口，而主流的模拟鼠标键盘方案都是调用win32 api，在游戏内部win32可以实现按键事件，点击事件，但是拖拽通常是实现不了，所以你可以试试本包。</p>
<p>大漠插件是用vb语言写的一个闭源且收费的的dll，而且它没有官网，网上好多都是注入病毒包装的dm.dll，不懂电脑的要慎重使用网上下载的插件。</p>
<p>这就是一个模拟键盘鼠标的库，如果你有其他需求，我相信python一定有其他包可以实现。</p>
<h3 id="_8">系统权限</h3>
<ul>
<li>右键-管理员运行</li>
<li>
<p>使用UCA-通过Python的ctypes</p>
<p>管理员运行cmd命令，/C代表打开执行之后直接关闭
注意cmd会直接运行你传入的命令，如果你使用/K 参数保留命令行，不会显示你传入的命令，但确实已经执行了，如果有回显你才会看到
ctypes.windll.shell32.ShellExecuteW(None, "runas", "cmd.exe", "/C %s" % self.cmd_un_dll, None, 1)</p>
<p>管理员运行本程序代码，通常在最开始执行，即整个代码以管理员运行
ctypes.windll.shell32.ShellExecuteW(None, "runas", sys.executable, <strong>file</strong>, None, 1)</p>
</li>
</ul>
<h3 id="_9">键盘代码</h3>
<table>
<thead>
<tr>
<th>key_str</th>
<th>虚拟键码</th>
</tr>
</thead>
<tbody>
<tr>
<td>"1",</td>
<td>49</td>
</tr>
<tr>
<td>"2",</td>
<td>50</td>
</tr>
<tr>
<td>"3",</td>
<td>51</td>
</tr>
<tr>
<td>"4",</td>
<td>52</td>
</tr>
<tr>
<td>"5",</td>
<td>53</td>
</tr>
<tr>
<td>"6",</td>
<td>54</td>
</tr>
<tr>
<td>"7",</td>
<td>55</td>
</tr>
<tr>
<td>"8",</td>
<td>56</td>
</tr>
<tr>
<td>"9",</td>
<td>57</td>
</tr>
<tr>
<td>"0",</td>
<td>48</td>
</tr>
<tr>
<td>"-",</td>
<td>189</td>
</tr>
<tr>
<td>"=",</td>
<td>187</td>
</tr>
<tr>
<td>"back",</td>
<td>8</td>
</tr>
<tr>
<td>"a",</td>
<td>65</td>
</tr>
<tr>
<td>"b",</td>
<td>66</td>
</tr>
<tr>
<td>"c",</td>
<td>67</td>
</tr>
<tr>
<td>"d",</td>
<td>68</td>
</tr>
<tr>
<td>"e",</td>
<td>69</td>
</tr>
<tr>
<td>"f",</td>
<td>70</td>
</tr>
<tr>
<td>"g",</td>
<td>71</td>
</tr>
<tr>
<td>"h",</td>
<td>72</td>
</tr>
<tr>
<td>"i",</td>
<td>73</td>
</tr>
<tr>
<td>"j",</td>
<td>74</td>
</tr>
<tr>
<td>"k",</td>
<td>75</td>
</tr>
<tr>
<td>"l",</td>
<td>76</td>
</tr>
<tr>
<td>"m",</td>
<td>77</td>
</tr>
<tr>
<td>"n",</td>
<td>78</td>
</tr>
<tr>
<td>"o",</td>
<td>79</td>
</tr>
<tr>
<td>"p",</td>
<td>80</td>
</tr>
<tr>
<td>"q",</td>
<td>81</td>
</tr>
<tr>
<td>"r",</td>
<td>82</td>
</tr>
<tr>
<td>"s",</td>
<td>83</td>
</tr>
<tr>
<td>"t",</td>
<td>84</td>
</tr>
<tr>
<td>"u",</td>
<td>85</td>
</tr>
<tr>
<td>"v",</td>
<td>86</td>
</tr>
<tr>
<td>"w",</td>
<td>87</td>
</tr>
<tr>
<td>"x",</td>
<td>88</td>
</tr>
<tr>
<td>"y",</td>
<td>89</td>
</tr>
<tr>
<td>"z",</td>
<td>90</td>
</tr>
<tr>
<td>"ctrl",</td>
<td>17</td>
</tr>
<tr>
<td>"alt",</td>
<td>18</td>
</tr>
<tr>
<td>"shift",</td>
<td>16</td>
</tr>
<tr>
<td>"win",</td>
<td>91</td>
</tr>
<tr>
<td>"space",</td>
<td>32</td>
</tr>
<tr>
<td>"cap",</td>
<td>20</td>
</tr>
<tr>
<td>"tab",</td>
<td>9</td>
</tr>
<tr>
<td>"~",</td>
<td>192</td>
</tr>
<tr>
<td>"esc",</td>
<td>27</td>
</tr>
<tr>
<td>"enter",</td>
<td>13</td>
</tr>
<tr>
<td>"up",</td>
<td>38</td>
</tr>
<tr>
<td>"down",</td>
<td>40</td>
</tr>
<tr>
<td>"left",</td>
<td>37</td>
</tr>
<tr>
<td>"right",</td>
<td>39</td>
</tr>
<tr>
<td>"option",</td>
<td>93</td>
</tr>
<tr>
<td>"print",</td>
<td>44</td>
</tr>
<tr>
<td>"delete",</td>
<td>46</td>
</tr>
<tr>
<td>"home",</td>
<td>36</td>
</tr>
<tr>
<td>"end",</td>
<td>35</td>
</tr>
<tr>
<td>"pgup",</td>
<td>33</td>
</tr>
<tr>
<td>"pgdn",</td>
<td>34</td>
</tr>
<tr>
<td>"f1",</td>
<td>112</td>
</tr>
<tr>
<td>"f2",</td>
<td>113</td>
</tr>
<tr>
<td>"f3",</td>
<td>114</td>
</tr>
<tr>
<td>"f4",</td>
<td>115</td>
</tr>
<tr>
<td>"f5",</td>
<td>116</td>
</tr>
<tr>
<td>"f6",</td>
<td>117</td>
</tr>
<tr>
<td>"f7",</td>
<td>118</td>
</tr>
<tr>
<td>"f8",</td>
<td>119</td>
</tr>
<tr>
<td>"f9",</td>
<td>120</td>
</tr>
<tr>
<td>"f10",</td>
<td>121</td>
</tr>
<tr>
<td>"f11",</td>
<td>122</td>
</tr>
<tr>
<td>"f12",</td>
<td>123</td>
</tr>
<tr>
<td>"[",</td>
<td>219</td>
</tr>
<tr>
<td>"]",</td>
<td>221</td>
</tr>
<tr>
<td>"\",</td>
<td>220</td>
</tr>
<tr>
<td>";",</td>
<td>186</td>
</tr>
<tr>
<td>"'",</td>
<td>222</td>
</tr>
<tr>
<td>",",</td>
<td>188</td>
</tr>
<tr>
<td>".",</td>
<td>190</td>
</tr>
<tr>
<td>"/",</td>
<td>191</td>
</tr>
</tbody>
</table>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="doc/" class="btn btn-neutral float-right" title="文档">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
      <span><a href="doc/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '.';</script>
    <script src="js/theme_extra.js" defer></script>
    <script src="js/theme.js" defer></script>
      <script src="search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>

<!--
MkDocs version : 1.2.3
Build Date UTC : 2021-10-24 14:02:52.605228+00:00
-->
